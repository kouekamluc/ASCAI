{% extends "base.html" %}
{% load i18n %}

{% block title %}{{ job.title }} - ASCAI{% endblock %}

{% block content %}
<article class="job-detail">
    <header class="job-header">
        <div class="job-meta">
            <span class="job-type-badge job-type-{{ job.job_type }}">
                {{ job.get_job_type_display }}
            </span>
            <span class="job-date">{{ job.posted_at|date:"F d, Y" }}</span>
        </div>
        <h1>{{ job.title }}</h1>
        <div class="job-company-info">
            <div>
                <p style="margin: 0.5rem 0;"><strong>{% trans "Company" %}:</strong> {{ job.company_name }}</p>
                <p style="margin: 0.5rem 0;"><strong>{% trans "Location" %}:</strong> üìç {{ job.location }}</p>
            </div>
            <div class="job-stats">
                <span>üëÅÔ∏è {% blocktrans count count=job.views_count %}{{ count }} view{% plural %}{{ count }} views{% endblocktrans %}</span>
                <span>üìù {% blocktrans count count=application_count %}{{ count }} application{% plural %}{{ count }} applications{% endblocktrans %}</span>
            </div>
        </div>
        {% if job.posted_by == user %}
            <div class="job-actions">
                <a href="{% url 'jobs:edit' job.slug %}" class="btn btn-secondary">‚úèÔ∏è {% trans "Edit" %}</a>
                <a href="{% url 'jobs:delete' job.slug %}" class="btn btn-danger">üóëÔ∏è {% trans "Delete" %}</a>
                <a href="{% url 'jobs:manage_applications' job.slug %}" class="btn btn-primary">üìã {% trans "Manage Applications" %}</a>
            </div>
        {% endif %}
    </header>
    
    <div class="job-content">
        {% if job.salary_min or job.salary_max %}
        {% load l10n %}
        <div class="job-salary-info">
            <strong>{% trans "Salary Range" %}:</strong>
            {% if job.salary_min and job.salary_max %}
                {% localize on %}
                    ‚Ç¨{{ job.salary_min|floatformat:0 }} - ‚Ç¨{{ job.salary_max|floatformat:0 }}
                {% endlocalize %}
            {% elif job.salary_min %}
                {% trans "From" %} {% localize on %}‚Ç¨{{ job.salary_min|floatformat:0 }}{% endlocalize %}
            {% elif job.salary_max %}
                {% trans "Up to" %} {% localize on %}‚Ç¨{{ job.salary_max|floatformat:0 }}{% endlocalize %}
            {% endif %}
        </div>
        {% endif %}
        
        {% if job.deadline %}
        <div class="job-deadline-info">
            <strong>‚è∞ {% trans "Application Deadline" %}:</strong> {{ job.deadline|date:"F d, Y H:i" }}
        </div>
        {% endif %}
        
        <div class="job-description">
            <h2>{% trans "Job Description" %}</h2>
            <p>{{ job.description|linebreaks }}</p>
        </div>
        
        {% if job.requirements %}
        <div class="job-requirements">
            <h2>{% trans "Requirements" %}</h2>
            <p>{{ job.requirements|linebreaks }}</p>
        </div>
        {% endif %}
        
        <div class="job-posted-by">
            <small>{% trans "Posted by" %} {{ job.posted_by.full_name }}</small>
        </div>
    </div>
    
    <!-- Apply Section -->
    {% if user.is_authenticated %}
        {% if job.posted_by != user %}
            {% if has_applied %}
                <div class="apply-section already-applied">
                    <p>{% trans "You have already applied to this job." %}</p>
                    <a href="{% url 'jobs:my_applications' %}" class="btn btn-secondary">{% trans "View My Applications" %}</a>
                </div>
            {% elif can_apply %}
                <div class="apply-section">
                    <a href="{% url 'jobs:apply' job.slug %}" class="btn btn-primary btn-large">üì§ {% trans "Apply Now" %}</a>
                    <p style="margin-top: 1rem; font-size: 0.9375rem; color: #80868b;">
                        {% trans "Submit your resume and cover letter to apply for this position" %}
                    </p>
                </div>
            {% else %}
                <div class="apply-section application-closed">
                    <p>{% trans "This job is no longer accepting applications." %}</p>
                </div>
            {% endif %}
        {% endif %}
    {% else %}
        <div class="apply-section login-required">
            <p>{% trans "Please log in to apply for this job." %}</p>
            <a href="{% url 'accounts:login' %}" class="btn btn-primary">{% trans "Log In" %}</a>
        </div>
    {% endif %}
    
    <div class="back-link">
        <a href="{% url 'jobs:list' %}" class="btn btn-secondary">‚Üê {% trans "Back to Job Board" %}</a>
    </div>
</article>
{% endblock %}

