{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "Students - ASCAI" %}{% endblock %}

{% block content %}
<div class="reddit-landing-wrapper">
    <!-- Hero Section -->
    <div class="container">
        <div class="reddit-hero">
            <h1 class="reddit-hero-title">{% trans "For Students" %}</h1>
            <p class="reddit-hero-subtitle">{% trans "Everything you need to know about studying in Lazio" %}</p>
        </div>
    </div>

    <!-- Main Content -->
    <div class="reddit-container">
        <div class="reddit-main-feed">
            <!-- Universities Section -->
            <div class="reddit-section-header">
                <h2 class="reddit-section-title">{% trans "Universities in Lazio" %}</h2>
            </div>
            
            {% if universities %}
            <div class="reddit-search">
                <form method="get" style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                    <input type="text" name="search" value="{{ search_query }}" placeholder="{% trans 'Search universities or programs...' %}" class="reddit-search-input" style="flex: 1;">
                    <button type="submit" class="reddit-btn reddit-btn-primary">{% trans "Search" %}</button>
                    {% if search_query %}
                    <a href="{% url 'dashboard:students' %}" class="reddit-btn reddit-btn-outline">{% trans "Clear" %}</a>
                    {% endif %}
                </form>
                {% if search_query %}
                <p style="font-size: 0.875rem; color: var(--reddit-text-secondary); margin-bottom: 1rem;">
                    {% trans "Search results for" %}: <strong>{{ search_query }}</strong>
                </p>
                {% endif %}
            </div>

            {% for university in universities %}
            <div class="reddit-university-card">
                <div class="reddit-university-icon">
                    {% if university.logo %}
                    <img src="{{ university.logo.url }}" alt="{{ university.name }}" style="width: 100%; height: 100%; object-fit: contain;" onerror="this.style.display='none'; this.parentElement.innerHTML='<svg width=\'20\' height=\'20\' viewBox=\'0 0 24 24\' fill=\'none\' stroke=\'currentColor\' stroke-width=\'2\'><path d=\'M4 19.5A2.5 2.5 0 0 1 6.5 17H20\'></path><path d=\'M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z\'></path></svg>';">
                    {% else %}
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                        <path d="M9 10h6"></path>
                        <path d="M9 14h6"></path>
                    </svg>
                    {% endif %}
                </div>
                <div class="reddit-university-info">
                    {% if university.url %}
                    <a href="{{ university.url }}" target="_blank" rel="noopener" class="reddit-university-name">{{ university.name }}</a>
                    {% else %}
                    <span class="reddit-university-name">{{ university.name }}</span>
                    {% endif %}
                    {% if university.location %}
                    <div class="reddit-university-location">üìç {{ university.location }}</div>
                    {% endif %}
                    {% if university.description %}
                    <p style="font-size: 0.875rem; color: var(--reddit-text-secondary); margin-top: 0.5rem; line-height: 1.5;">{{ university.description|truncatewords:20 }}</p>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
            {% else %}
            <div class="reddit-sidebar-card">
                <div class="reddit-sidebar-content">
                    <p style="text-align: center; color: var(--reddit-text-secondary); padding: 2rem;">
                        {% trans "No universities listed yet. Check back soon!" %}
                    </p>
                </div>
            </div>
            {% endif %}

            <div class="cameroon-flag-accent"></div>

            <!-- Scholarships Section -->
            <div class="reddit-section-header">
                <h2 class="reddit-section-title">{% trans "Scholarships & Funding" %}</h2>
                <a href="{% url 'events:list' %}" class="reddit-btn reddit-btn-outline">{% trans "View All" %}</a>
            </div>
            
            {% if scholarships %}
            {% for scholarship in scholarships %}
            <div class="reddit-post-card" onclick="window.location.href='{% url 'events:detail' scholarship.slug %}'">
                <div class="reddit-post-vote">
                    <button class="reddit-vote-button" aria-label="{% trans 'Upvote' %}">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M10 2L3 9h4v8h6v-8h4L10 2z"/>
                        </svg>
                    </button>
                    <span class="reddit-vote-count">‚Ä¢</span>
                    <button class="reddit-vote-button downvote" aria-label="{% trans 'Downvote' %}">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M10 18l7-7h-4V3H7v8H3l7 7z"/>
                        </svg>
                    </button>
                </div>
                <div class="reddit-post-content">
                    <div class="reddit-post-header">
                        <span class="reddit-post-subreddit">r/ASCAI-Scholarships</span>
                        <span>‚Ä¢</span>
                        <span class="reddit-post-author">{{ scholarship.start_date|date:"M d, Y" }}</span>
                        {% if scholarship.category %}
                        <span>‚Ä¢</span>
                        <span style="color: {{ scholarship.category.color }};">{{ scholarship.category.name }}</span>
                        {% endif %}
                    </div>
                    <a href="{% url 'events:detail' scholarship.slug %}" class="reddit-post-title">{{ scholarship.title }}</a>
                    {% if scholarship.description %}
                    <p class="reddit-post-body">{{ scholarship.description|truncatewords:30 }}</p>
                    {% endif %}
                    {% if scholarship.featured_image %}
                    <img src="{{ scholarship.featured_image.url }}" alt="{{ scholarship.title }}" class="reddit-post-image" onerror="this.style.display='none';">
                    {% endif %}
                    <div class="reddit-post-footer">
                        <div class="reddit-post-action">
                            <span>üìç {{ scholarship.location }}</span>
                        </div>
                        {% if scholarship.is_registration_required %}
                        <div class="reddit-post-action">
                            <span style="color: var(--cameroon-red); font-weight: 600;">{% trans "Registration Required" %}</span>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
            {% else %}
            <div class="reddit-sidebar-card">
                <div class="reddit-sidebar-content">
                    <p style="text-align: center; color: var(--reddit-text-secondary); padding: 2rem;">
                        {% trans "No scholarships available at the moment. Check back later!" %}
                    </p>
                </div>
            </div>
            {% endif %}

            <div class="cameroon-flag-accent"></div>

            <!-- Study News Section -->
            <div class="reddit-section-header">
                <h2 class="reddit-section-title">{% trans "Study News & Updates" %}</h2>
                <a href="{% url 'news:list' %}" class="reddit-btn reddit-btn-outline">{% trans "View All" %}</a>
            </div>
            
            {% if study_news %}
            {% for news in study_news %}
            <div class="reddit-post-card" onclick="window.location.href='{% url 'news:detail' news.slug %}'">
                <div class="reddit-post-vote">
                    <button class="reddit-vote-button" aria-label="{% trans 'Upvote' %}">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M10 2L3 9h4v8h6v-8h4L10 2z"/>
                        </svg>
                    </button>
                    <span class="reddit-vote-count">‚Ä¢</span>
                    <button class="reddit-vote-button downvote" aria-label="{% trans 'Downvote' %}">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M10 18l7-7h-4V3H7v8H3l7 7z"/>
                        </svg>
                    </button>
                </div>
                <div class="reddit-post-content">
                    <div class="reddit-post-header">
                        <span class="reddit-post-subreddit">r/ASCAI-News</span>
                        <span>‚Ä¢</span>
                        <span class="reddit-post-author">{{ news.published_at|date:"M d, Y"|default:news.created_at|date:"M d, Y" }}</span>
                        {% if news.category %}
                        <span>‚Ä¢</span>
                        <span>{{ news.category.name }}</span>
                        {% endif %}
                    </div>
                    <a href="{% url 'news:detail' news.slug %}" class="reddit-post-title">{{ news.title }}</a>
                    {% if news.excerpt %}
                    <p class="reddit-post-body">{{ news.excerpt|truncatewords:30 }}</p>
                    {% endif %}
                    {% if news.featured_image %}
                    <img src="{{ news.featured_image.url }}" alt="{{ news.title }}" class="reddit-post-image" onerror="this.style.display='none';">
                    {% endif %}
                </div>
            </div>
            {% endfor %}
            {% else %}
            <div class="reddit-sidebar-card">
                <div class="reddit-sidebar-content">
                    <p style="text-align: center; color: var(--reddit-text-secondary); padding: 2rem;">
                        {% trans "No study-related news at the moment." %}
                    </p>
                </div>
            </div>
            {% endif %}

            <div class="cameroon-flag-accent"></div>

            <!-- Exchange Programs Section -->
            <div class="reddit-section-header">
                <h2 class="reddit-section-title">{% trans "Exchange Programs" %}</h2>
            </div>
            
            {% if exchange_programs %}
            <div class="reddit-feature-grid">
                {% for program in exchange_programs %}
                <div class="reddit-feature-card">
                    <div class="reddit-feature-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                    </div>
                    <h3 class="reddit-feature-title">{{ program.name }}</h3>
                    <p class="reddit-feature-description">{{ program.description }}</p>
                    {% if program.url %}
                    <a href="{{ program.url }}" target="_blank" rel="noopener" class="reddit-btn reddit-btn-cameroon">{% trans "Learn More" %}</a>
                    {% else %}
                    <a href="{% url 'news:list' %}" class="reddit-btn reddit-btn-cameroon">{% trans "Learn More" %}</a>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="reddit-sidebar-card">
                <div class="reddit-sidebar-content">
                    <p style="text-align: center; color: var(--reddit-text-secondary); padding: 2rem;">
                        {% trans "No exchange programs listed yet." %}
                    </p>
                </div>
            </div>
            {% endif %}
        </div>

        <!-- Sidebar -->
        <aside class="reddit-sidebar">
            <div class="reddit-sidebar-card">
                <div class="reddit-sidebar-header">
                    <span>{% trans "Quick Links" %}</span>
                </div>
                <div class="reddit-sidebar-content">
                    <a href="{% url 'dashboard:index' %}" class="reddit-sidebar-item">
                        <span class="reddit-sidebar-number">üè†</span>
                        <span class="reddit-sidebar-text">{% trans "Home" %}</span>
                    </a>
                    <a href="{% url 'events:list' %}" class="reddit-sidebar-item">
                        <span class="reddit-sidebar-number">üìÖ</span>
                        <span class="reddit-sidebar-text">{% trans "All Events" %}</span>
                    </a>
                    <a href="{% url 'news:list' %}" class="reddit-sidebar-item">
                        <span class="reddit-sidebar-number">üì∞</span>
                        <span class="reddit-sidebar-text">{% trans "All News" %}</span>
                    </a>
                    <a href="{% url 'documents:list' %}" class="reddit-sidebar-item">
                        <span class="reddit-sidebar-number">üìÑ</span>
                        <span class="reddit-sidebar-text">{% trans "Documents" %}</span>
                    </a>
                </div>
            </div>
        </aside>
    </div>
</div>
{% endblock %}
