<!DOCTYPE html>
{% load i18n %}
{% get_current_language as LANGUAGE_CODE %}
<html lang="{{ LANGUAGE_CODE }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{% trans "ASCAI - Association of Cameroonian Students in Lazio" %}{% endblock %}</title>
    {% load static %}
    <!-- Google Fonts - Professional Typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Design System -->
    <link rel="stylesheet" href="{% static 'css/design-system.css' %}">
    <link rel="stylesheet" href="{% static 'css/sidebar.css' %}">
    <link rel="stylesheet" href="{% static 'css/tables.css' %}">
    <link rel="stylesheet" href="{% static 'css/compatibility.css' %}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/reddit-landing.css' %}">
    {% block extra_css %}{% endblock %}
    <style>
        .form-hint a {
            color: var(--primary-green);
            text-decoration: underline;
        }
        .form-hint a:hover {
            color: var(--primary-red);
        }
    </style>
</head>
<body>
    {% load i18n %}
    
    {% if user.is_authenticated %}
    <!-- Vertical Sidebar Navigation -->
    <aside class="sidebar" id="sidebar" role="navigation" aria-label="{% trans 'Main navigation' %}">
        <button class="sidebar-toggle" aria-label="{% trans 'Toggle sidebar' %}" id="sidebar-toggle">
            <span class="icon icon-chevron-left"></span>
        </button>
        
        <div class="sidebar-brand">
            <div class="logo">A</div>
            <div class="logo-text">ASCAI</div>
        </div>
        
        <nav class="sidebar-nav">
            <a href="{% url 'dashboard:home' %}" class="sidebar-nav-item {% if request.resolver_match.url_name == 'home' %}active{% endif %}" aria-label="{% trans 'Dashboard' %}">
                <span class="icon icon-dashboard"></span>
                <span class="text">{% trans "Dashboard" %}</span>
            </a>
            {% if user.is_admin or user.is_board_member %}
            <a href="{% url 'dashboard:admin' %}" class="sidebar-nav-item {% if request.resolver_match.url_name == 'admin' %}active{% endif %}" aria-label="{% trans 'Admin panel' %}">
                <span class="icon icon-admin"></span>
                <span class="text">{% trans "Admin" %}</span>
            </a>
            {% endif %}
            <a href="{% url 'events:list' %}" class="sidebar-nav-item {% if 'events' in request.resolver_match.app_name %}active{% endif %}" aria-label="{% trans 'Events' %}">
                <span class="icon icon-events"></span>
                <span class="text">{% trans "Events" %}</span>
            </a>
            <a href="{% url 'news:list' %}" class="sidebar-nav-item {% if 'news' in request.resolver_match.app_name %}active{% endif %}" aria-label="{% trans 'News' %}">
                <span class="icon icon-news"></span>
                <span class="text">{% trans "News" %}</span>
            </a>
            <a href="{% url 'forums:category_list' %}" class="sidebar-nav-item {% if 'forums' in request.resolver_match.app_name %}active{% endif %}" aria-label="{% trans 'Forum' %}">
                <span class="icon icon-forum"></span>
                <span class="text">{% trans "Forum" %}</span>
            </a>
            <a href="{% url 'documents:list' %}" class="sidebar-nav-item {% if 'documents' in request.resolver_match.app_name %}active{% endif %}" aria-label="{% trans 'Documents' %}">
                <span class="icon icon-documents"></span>
                <span class="text">{% trans "Documents" %}</span>
            </a>
            <a href="{% url 'jobs:list' %}" class="sidebar-nav-item {% if 'jobs' in request.resolver_match.app_name %}active{% endif %}" aria-label="{% trans 'Jobs' %}">
                <span class="icon icon-jobs"></span>
                <span class="text">{% trans "Jobs" %}</span>
            </a>
            {% if user.is_admin %}
            <a href="{% url 'members:directory' %}" class="sidebar-nav-item {% if 'members' in request.resolver_match.app_name %}active{% endif %}" aria-label="{% trans 'Members directory' %}">
                <span class="icon icon-members"></span>
                <span class="text">{% trans "Members" %}</span>
            </a>
            {% endif %}
            <a href="{% url 'messaging:chat_list' %}" class="sidebar-nav-item {% if 'messaging' in request.resolver_match.app_name %}active{% endif %}" aria-label="{% trans 'Messages' %}" id="messages-nav-link">
                <span class="icon icon-messages"></span>
                <span class="text">{% trans "Messages" %}</span>
                <span class="notification-badge" id="messages-notification-badge" style="display: none;"></span>
            </a>
            <a href="{% url 'accounts:profile' %}" class="sidebar-nav-item {% if 'accounts' in request.resolver_match.app_name and request.resolver_match.url_name == 'profile' %}active{% endif %}" aria-label="{% trans 'Profile' %}">
                <span class="icon icon-profile"></span>
                <span class="text">{% trans "Profile" %}</span>
            </a>
        </nav>
        
        <div class="sidebar-user">
            <div class="sidebar-user-content">
                <div class="sidebar-user-avatar">
                    {{ user.first_name|first|upper }}{{ user.last_name|first|upper }}
                </div>
                <div class="sidebar-user-info">
                    <div class="sidebar-user-name">{{ user.full_name }}</div>
                    <div class="sidebar-user-email">{{ user.email|truncatechars:20 }}</div>
                </div>
            </div>
            <form method="post" action="{% url 'accounts:logout' %}" style="margin-top: 0.5rem; margin: 0; padding: 0;">
                {% csrf_token %}
                <button type="submit" class="sidebar-nav-item" aria-label="{% trans 'Logout' %}" style="width: 100%; text-align: left; background: none; border: none; padding: 0.75rem 1rem; cursor: pointer; display: flex; align-items: center; gap: 0.75rem; color: inherit; font-size: inherit; font-family: inherit;">
                    <span class="icon icon-logout"></span>
                    <span class="text">{% trans "Logout" %}</span>
                </button>
            </form>
        </div>
    </aside>
    
    <!-- Sidebar Overlay (Mobile) -->
    <div class="sidebar-overlay" id="sidebar-overlay"></div>
    {% else %}
    <!-- Public Navigation Overlay (Mobile) -->
    <div class="public-nav-overlay" id="public-nav-overlay"></div>
    <!-- Public Header -->
    <header class="public-header">
        <!-- Top Bar -->
        <div class="public-header-top">
            <div class="container">
                <div class="public-header-top-left">
                    <span class="public-header-follow">{% trans "Follow us on" %}</span>
                    <a href="#" class="social-link" aria-label="{% trans 'Instagram' %}" target="_blank" rel="noopener">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                        </svg>
                    </a>
                    <a href="#" class="social-link" aria-label="{% trans 'YouTube' %}" target="_blank" rel="noopener">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                        </svg>
                    </a>
                    <a href="#" class="social-link" aria-label="{% trans 'WhatsApp' %}" target="_blank" rel="noopener">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                        </svg>
                    </a>
                </div>
                <div class="public-header-top-right">
                    <a href="{% url 'accounts:login' %}" class="public-header-login">{% trans "AREA RISERVATA" %}</a>
                    {% include "includes/language_switcher.html" %}
                </div>
            </div>
        </div>
        
        <!-- Main Navigation -->
        <nav class="public-header-nav">
            <div class="container">
                <div class="public-header-brand">
                    <a href="{% url 'dashboard:index' %}" class="public-logo">
                        <div class="public-logo-icon">A</div>
                        <div class="public-logo-text">
                            <div class="public-logo-title">ASCAI</div>
                            <div class="public-logo-subtitle">{% trans "Association of Cameroonian Students in Lazio" %}</div>
                        </div>
                    </a>
                </div>
                <button class="public-nav-toggle" id="public-nav-toggle" aria-label="{% trans 'Toggle navigation' %}">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <ul class="public-nav-menu" id="public-nav-menu">
                    <li><a href="{% url 'dashboard:index' %}" class="{% if request.resolver_match.url_name == 'index' and request.resolver_match.app_name == 'dashboard' %}active{% endif %}">{% trans "Home" %}</a></li>
                    <li><a href="{% url 'dashboard:students' %}" class="{% if request.resolver_match.url_name == 'students' and request.resolver_match.app_name == 'dashboard' %}active{% endif %}">{% trans "Students" %}</a></li>
                    <li><a href="{% url 'dashboard:diaspora' %}" class="{% if request.resolver_match.url_name == 'diaspora' and request.resolver_match.app_name == 'dashboard' %}active{% endif %}">{% trans "Diaspora" %}</a></li>
                    <li><a href="{% url 'forums:category_list' %}" class="{% if request.resolver_match.app_name == 'forums' %}active{% endif %}">{% trans "Community" %}</a></li>
                    <li><a href="{% url 'dashboard:resources' %}" class="{% if request.resolver_match.url_name == 'resources' and request.resolver_match.app_name == 'dashboard' %}active{% endif %}">{% trans "Resources" %}</a></li>
                    <li><a href="{% url 'dashboard:contact' %}" class="{% if request.resolver_match.url_name == 'contact' and request.resolver_match.app_name == 'dashboard' %}active{% endif %}">{% trans "Contact" %}</a></li>
                </ul>
            </div>
        </nav>
        
        <!-- Contact Bar -->
        <div class="public-header-contact">
            <div class="container">
                <span class="public-header-contact-label">{% trans "Contact Us" %}</span>
                <a href="mailto:info@ascai.it" class="public-header-contact-phone">info@ascai.it</a>
            </div>
        </div>
    </header>
    {% endif %}

    <!-- Main Content Wrapper -->
    <div class="main-wrapper {% if user.is_authenticated %}{% else %}no-sidebar{% endif %}" id="main-wrapper">
        {% if user.is_authenticated %}
        <!-- Top Bar -->
        <header class="top-bar">
            <button class="mobile-menu-button" id="mobile-menu-button" aria-label="{% trans 'Toggle menu' %}">
                <span class="icon icon-menu"></span>
            </button>
            <h1 class="top-bar-title">{% block page_title %}{% trans "ASCAI" %}{% endblock %}</h1>
            <div class="top-bar-actions">
                {% include "includes/language_switcher.html" %}
            </div>
        </header>
        {% endif %}

        <!-- Breadcrumbs -->
        {% block breadcrumbs %}{% endblock %}

        <!-- Main Content -->
        <main class="main-content">
            {% if messages %}
                <div class="messages">
                    {% for message in messages %}
                        <div class="alert alert-{{ message.tags }}">{{ message }}</div>
                    {% endfor %}
                </div>
            {% endif %}

            {% block content %}{% endblock %}
        </main>
    </div>

    {% if not user.is_authenticated %}
    <footer class="public-footer">
        <div class="container">
            <div class="footer-content">
                <!-- Column 1: Informative Area -->
                <div class="footer-column">
                    <h3 class="footer-title">{% trans "AREA INFORMATIVA" %}</h3>
                    <ul class="footer-links">
                        <li><a href="{% url 'news:list' %}">{% trans "Benefits & Services" %}</a></li>
                        <li><a href="{% url 'news:list' %}">{% trans "Study in Lazio" %}</a></li>
                        <li><a href="{% url 'events:list' %}">{% trans "Calls" %}</a></li>
                        <li><a href="{% url 'members:apply' %}">{% trans "Citizens" %}</a></li>
                        <li><a href="{% url 'jobs:list' %}">{% trans "Businesses" %}</a></li>
                        <li><a href="{% url 'news:list' %}">{% trans "News & Events" %}</a></li>
                        <li><a href="{% url 'documents:list' %}">{% trans "Documents" %}</a></li>
                    </ul>
                    
                    <h3 class="footer-title">{% trans "CONTATTI" %}</h3>
                    <div class="footer-contact">
                        <p><strong>{% trans "Email" %}: info@ascai.it</strong></p>
                        <p>{% trans "Monday to Thursday" %} 9:30 - 16:30</p>
                        <p>{% trans "Friday" %} 9:30 - 13:00</p>
                        <p>{% trans "General inquiries" %}: info@ascai.it</p>
                        <p>{% trans "Membership" %}: membership@ascai.it</p>
                    </div>
                </div>
                
                <!-- Column 2: Institutional Area -->
                <div class="footer-column">
                    <h3 class="footer-title">{% trans "AREA ISTITUZIONALE" %}</h3>
                    <ul class="footer-links">
                        <li><a href="{% url 'dashboard:index' %}">{% trans "Organization" %}</a></li>
                        <li><a href="{% url 'documents:list' %}">{% trans "Forms" %}</a></li>
                        <li><a href="{% url 'news:list' %}">{% trans "Public Relations Office (URP)" %}</a></li>
                        <li><a href="{% url 'news:list' %}">{% trans "Whistleblowing" %}</a></li>
                    </ul>
                    
                    <h3 class="footer-title">{% trans "CONTATTI STUDENTI" %}</h3>
                    <div class="footer-contact">
                        <p><strong>{% trans "Student Support" %}: students@ascai.it</strong></p>
                        <p><strong>{% trans "Phone Support" %}</strong></p>
                        <p>{% trans "Monday to Thursday" %} 09:00 - 16:30</p>
                        <p>{% trans "Friday" %} 09:00 - 13:30</p>
                        <p><strong>{% trans "Public Reception" %}</strong></p>
                        <p>{% trans "Tuesday" %} 14:30 - 16:30</p>
                        <p>{% trans "Thursday" %} 10:30 - 12:30</p>
                    </div>
                    
                    <div class="footer-social">
                        <span class="footer-social-label">{% trans "Follow us on" %}</span>
                        <div class="footer-social-links">
                            <a href="#" class="social-link" aria-label="{% trans 'Instagram' %}" target="_blank" rel="noopener">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                                </svg>
                            </a>
                            <a href="#" class="social-link" aria-label="{% trans 'YouTube' %}" target="_blank" rel="noopener">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                                </svg>
                            </a>
                            <a href="#" class="social-link" aria-label="{% trans 'WhatsApp' %}" target="_blank" rel="noopener">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                                </svg>
                            </a>
                        </div>
                    </div>
                </div>
                
                <!-- Column 3: Transparency -->
                <div class="footer-column">
                    <h3 class="footer-title">{% trans "TRASPARENZA" %}</h3>
                    <ul class="footer-links">
                        <li><a href="{% url 'documents:list' %}">{% trans "Transparent Administration" %}</a></li>
                        <li><a href="{% url 'documents:list' %}">{% trans "Official Register" %}</a></li>
                        <li><a href="{% url 'documents:list' %}">{% trans "Service Charter" %}</a></li>
                        <li><a href="{% url 'dashboard:index' %}">{% trans "Intranet" %}</a></li>
                    </ul>
                    
                    <h3 class="footer-title">{% trans "CONTATTI IMPRESE" %}</h3>
                    <div class="footer-contact">
                        <p>{% trans "Partnerships and Business Inquiries" %}</p>
                        <p>{% trans "Email" %}: partnerships@ascai.it</p>
                        <p>{% trans "For job postings" %}: jobs@ascai.it</p>
                    </div>
                    
                    <div class="footer-member">
                        <p>{% trans "Join us" %}: <a href="{% url 'members:apply' %}" style="color: rgba(255, 255, 255, 0.9);">{% trans "Become a Member" %}</a></p>
                    </div>
                </div>
            </div>
            
            <!-- Bottom Bar -->
            <div class="footer-bottom">
                <div class="footer-logo">
                    <div class="footer-logo-icon">A</div>
                    <div class="footer-logo-text">
                        <div class="footer-logo-title">ASCAI</div>
                        <div class="footer-logo-subtitle">{% trans "Association of Cameroonian Students in Lazio" %}</div>
                    </div>
                </div>
                <div class="footer-bottom-links">
                    <a href="{% url 'documents:list' %}">{% trans "Accessibility Statement" %}</a>
                    <a href="{% url 'news:list' %}">{% trans "FAQ" %}</a>
                    <a href="{% url 'documents:list' %}">{% trans "Cookie Policy" %}</a>
                    <a href="{% url 'documents:list' %}">{% trans "Privacy Policy" %}</a>
                    <a href="{% url 'documents:list' %}">{% trans "Legal Notes" %}</a>
                </div>
            </div>
            <div class="footer-copyright">
                <p>&copy; {% now "Y" %} {% trans "ASCAI - Association of Cameroonian Students in Lazio, Italy" %}</p>
            </div>
        </div>
    </footer>
    {% endif %}

    <!-- HTMX Library -->
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    
    <!-- Form ID Fix - Prevents duplicate form field IDs -->
    <script src="{% static 'js/form-id-fix.js' %}"></script>
    
    <!-- Sidebar Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const sidebar = document.getElementById('sidebar');
            const sidebarToggle = document.getElementById('sidebar-toggle');
            const mainWrapper = document.getElementById('main-wrapper');
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const sidebarOverlay = document.getElementById('sidebar-overlay');
            
            // Load saved sidebar state
            const savedState = localStorage.getItem('sidebarCollapsed');
            if (savedState === 'true' && window.innerWidth > 1024) {
                sidebar.classList.add('collapsed');
                mainWrapper.classList.add('sidebar-collapsed');
            }
            
            // Desktop toggle
            if (sidebarToggle) {
                sidebarToggle.addEventListener('click', function() {
                    if (window.innerWidth > 1024) {
                        sidebar.classList.toggle('collapsed');
                        mainWrapper.classList.toggle('sidebar-collapsed');
                        localStorage.setItem('sidebarCollapsed', sidebar.classList.contains('collapsed'));
                    }
                });
            }
            
            // Mobile menu toggle
            if (mobileMenuButton) {
                mobileMenuButton.addEventListener('click', function() {
                    sidebar.classList.add('mobile-open');
                    sidebarOverlay.classList.add('active');
                    document.body.style.overflow = 'hidden';
                });
            }
            
            // Close mobile menu on overlay click
            if (sidebarOverlay) {
                sidebarOverlay.addEventListener('click', function() {
                    sidebar.classList.remove('mobile-open');
                    sidebarOverlay.classList.remove('active');
                    document.body.style.overflow = '';
                });
            }
            
            // Close mobile menu on escape key
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape' && sidebar && sidebar.classList.contains('mobile-open')) {
                    sidebar.classList.remove('mobile-open');
                    sidebarOverlay.classList.remove('active');
                    document.body.style.overflow = '';
                    if (mobileMenuButton) mobileMenuButton.focus();
                }
            });
            
            // Close mobile menu when clicking a link
            if (sidebar) {
                const sidebarLinks = sidebar.querySelectorAll('.sidebar-nav-item');
                sidebarLinks.forEach(link => {
                    link.addEventListener('click', function() {
                        if (window.innerWidth <= 1024) {
                            sidebar.classList.remove('mobile-open');
                            sidebarOverlay.classList.remove('active');
                            document.body.style.overflow = '';
                        }
                    });
                });
            }
            
            // Handle window resize
            window.addEventListener('resize', function() {
                if (window.innerWidth > 1024) {
                    if (sidebar) {
                        sidebar.classList.remove('mobile-open');
                    }
                    if (sidebarOverlay) {
                        sidebarOverlay.classList.remove('active');
                    }
                    document.body.style.overflow = '';
                }
            });
        });
    </script>
    
    <!-- Public Navigation Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const publicNavToggle = document.getElementById('public-nav-toggle');
            const publicNavMenu = document.getElementById('public-nav-menu');
            const publicNavOverlay = document.getElementById('public-nav-overlay');
            
            function openMenu() {
                if (publicNavMenu) {
                    publicNavMenu.classList.add('active');
                    if (publicNavOverlay) {
                        publicNavOverlay.classList.add('active');
                    }
                    document.body.style.overflow = 'hidden';
                }
            }
            
            function closeMenu() {
                if (publicNavMenu) {
                    publicNavMenu.classList.remove('active');
                    if (publicNavOverlay) {
                        publicNavOverlay.classList.remove('active');
                    }
                    document.body.style.overflow = '';
                }
            }
            
            if (publicNavToggle && publicNavMenu) {
                publicNavToggle.addEventListener('click', function() {
                    if (publicNavMenu.classList.contains('active')) {
                        closeMenu();
                    } else {
                        openMenu();
                    }
                });
                
                // Close menu when clicking overlay
                if (publicNavOverlay) {
                    publicNavOverlay.addEventListener('click', function() {
                        closeMenu();
                    });
                }
                
                // Close menu when clicking a link
                const navLinks = publicNavMenu.querySelectorAll('a');
                navLinks.forEach(link => {
                    link.addEventListener('click', function() {
                        closeMenu();
                    });
                });
                
                // Close menu on escape key
                document.addEventListener('keydown', function(event) {
                    if (event.key === 'Escape' && publicNavMenu.classList.contains('active')) {
                        closeMenu();
                        if (publicNavToggle) {
                            publicNavToggle.focus();
                        }
                    }
                });
                
                // Close menu on window resize
                window.addEventListener('resize', function() {
                    if (window.innerWidth > 1024 && publicNavMenu.classList.contains('active')) {
                        closeMenu();
                    }
                });
            }
        });
    </script>
    
    <!-- Message Notification Badge Updater -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const notificationBadge = document.getElementById('messages-notification-badge');
            
            function updateNotificationBadge() {
                fetch('{% url "messaging:unread_count" %}')
                    .then(response => response.json())
                    .then(data => {
                        if (data.unread_count > 0) {
                            notificationBadge.textContent = data.unread_count > 99 ? '99+' : data.unread_count;
                            notificationBadge.style.display = 'flex';
                            
                            // Add admin notification class if there are admin messages
                            if (data.admin_unread_count > 0) {
                                notificationBadge.classList.add('admin-notification');
                            } else {
                                notificationBadge.classList.remove('admin-notification');
                            }
                        } else {
                            notificationBadge.style.display = 'none';
                            notificationBadge.classList.remove('admin-notification');
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching unread count:', error);
                    });
            }
            
            // Update immediately on page load
            updateNotificationBadge();
            
            // Update every 30 seconds
            setInterval(updateNotificationBadge, 30000);
            
            // Also update when the page becomes visible (user switches tabs)
            document.addEventListener('visibilitychange', function() {
                if (!document.hidden) {
                    updateNotificationBadge();
                }
            });
        });
    </script>
    
    {% block extra_js %}{% endblock %}
</body>
</html>
